#!/bin/sh

DISABLE_COMPILE=1 uv run python pretrain.py \
    arch=totrm \
    data_paths="[data/sudoku-extreme-1k-aug-1000-eval-2pct]" \
    evaluators="[]" \
    epochs=20000 \
    eval_interval=500 \
    lr=1e-4 \
    puzzle_emb_lr=1e-4 \
    weight_decay=1.0 \
    puzzle_emb_weight_decay=1.0 \
    arch.H_layers=0 \
    arch.L_layers=2 \
    arch.H_cycles=3 \
    arch.L_cycles=6 \
    ema=True \
    arch.hidden_size=512 \
    arch.num_heads=8 \
    arch.expansion=4 \
    arch.forward_dtype=bfloat16 \
    global_batch_size=128 \
    arch.halt_exploration_prob=0.1 \
    arch.halt_max_steps=16 \
    arch.tree_branching_steps=3 \
    arch.tree_merge_method=mean \
    +entity="jhunforspeed-soongsil-univ" \
    +project_name="totrm-sudoku-extreme" \
    
    # TRM에서의 값
    # arch=totrm \
    # data_paths="[data/sudoku-extreme-1k-aug-1000]" \
    # evaluators="[]" \
    # epochs=50000 \
    # eval_interval=5000 \
    # lr=1e-4 \
    # puzzle_emb_lr=1e-4 \
    # weight_decay=1.0 \
    # puzzle_emb_weight_decay=1.0 \
    # arch.H_layers=0 \
    # arch.L_layers=2 \
    # arch.H_cycles=3 \
    # arch.L_cycles=6 \
    # ema=True \
    # arch.hidden_size=512 \
    # arch.num_heads=8 \
    # arch.expansion=4 \
    # arch.forward_dtype=bfloat16 \
    # global_batch_size=768 \
    # arch.halt_exploration_prob=0.1 \
    # arch.halt_max_steps=16 \
    # +entity="jhunforspeed-soongsil-univ" \
    # +project_name="totrm" \

    # olivkoch 코드 원본
    # arch=totrm \
    # data_paths="[data/sudoku9x9]" \
    # arch.halt_exploration_prob=0.0 \
    # arch.halt_max_steps=4 \
    # arch.H_cycles=2 \
    # arch.L_cycles=4 \
    # arch.tree_branching_steps=3 \
    # arch.tree_merge_method=mean \
    # arch.H_layers=0 \
    # arch.L_layers=1 \
    # arch.hidden_size=64 \
    # arch.num_heads=2 \
    # arch.expansion=2 \
    # arch.puzzle_emb_ndim=4 \
    # arch.forward_dtype=float32 \
    # arch.puzzle_emb_len=4 \
    # global_batch_size=256 \
    # epochs=1000 \
    # lr=0.001 \
    # puzzle_emb_lr=0.01 \
    # weight_decay=0.0 \
    # puzzle_emb_weight_decay=0.0 \
    # lr_warmup_steps=0 \
    # eval_interval=100 \
    # +entity="jhunforspeed-soongsil-univ" \
    # +project_name="totrm"
